<!DOCTYPE html>
<html>
<head>
<title>Search</title>
</head>
<body>
<script>
function makeRequest(method, url, useProxy, callback) {
  // Method in your case will always be "GET" (you aren't changing any data on the server)
  // URL is the URL you are going to retrieve (examples given in previous posts)
  // UseProxy will default to true since APIs like Hopscotch's are normally restricted to same origin
  // Callback is a function that will handle the data retrieved from the API
  
  // Update the URL to the proxy URL so you can retrieve data without "same origin" restriction
  if (useProxy) url = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url)
  
  // Begin a new request
  let xhr = new XMLHttpRequest();
  // This defines where the request will be made and its method
  xhr.open(method, url);
  // When the request loads OR fails, execute the callback function
  xhr.onload = xhr.onerror = function() {

  <script>
 function makeRequest(method, url, useProxy, callback) {
  // Method in your case will always be "GET" (you aren't changing any data on the server)
  // URL is the URL you are going to retrieve (examples given in previous posts)
  // UseProxy will default to true since APIs like Hopscotch's are normally restricted to same origin
  // Callback is a function that will handle the data retrieved from the API
  
  // Update the URL to the proxy URL so you can retrieve data without "same origin" restriction
  if (useProxy) url = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url)
  
  // Begin a new request
  let xhr = new XMLHttpRequest();
  // This defines where the request will be made and its method
  xhr.open(method, url);
  // When the request loads OR fails, execute the callback function
  xhr.onload = xhr.onerror = function() {
    // Pass in the response text and status
    callback(xhr.responseText, xhr.status)
  }
  // Send the request
  xhr.send()
}

// Example Request to load my favorites
makeRequest('GET', 'https://community.gethopscotch.com/api/v2/users/452673/published_projects?api_token=4f7769439adf7ef8e482d2daef77375cd6d0158b65fcdca543b74b5c0c92&user%5Bauth_token%5D=qKok4lCx8YB9Wgp%2Bo862AA%3D%3D&user%5Bid%5D=4753230', true, function (response, status) {
  // Our makeRequest function will run this function you passed in with the response text and request status code (e.g. 200 for OK, 404 for not found)
  // Only caveat is that the proxy (all origins) will always return 200 unless their server is down
  // Because of that, we won't deal with status much with this code, so the focus will be on the response

  console.log(response, status) // {<JSON text>} 200
  console.log('here is the JSON response of my favorites tab')
  console.log(JSON.parse(response)) // >> Object {}
  let json_data = JSON.parse(response)

  // Add the first project's UUID to the text of an element with ID 'output'
  document.getElementById('output').innerText = json_data.projects[0].uuid
  // test to make a link
  var projectuuid = json_data.projects[1].uuid
  var project = "c.gethopscotch.com/p/"+projectuuid
  document.getElementById('project').innerText = "c.gethopscotch.com/p/"+json_data.projects[1].uuid
  var link2 = str.link("c.gethopscotch.com/p/"+projectuuid);
  var link3 = "c.gethopscotch.com/p/"+json_data.projects[1].uuid;

}) 
  </script>
  
  <h1>test</h1>
  
  <div id="output"></div>
</body>
</html>
